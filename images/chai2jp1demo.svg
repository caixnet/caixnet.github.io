<?xml version="1.0" encoding="utf-8" ?>
<svg id="drawing" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="320" height="70">
<!--  <script type="text/javascript" xlink:href="chai2jp.js"></script> -->
<!-- <?xml-stylesheet  href="../css/custom-style.css" type="text/css" ?> -->
<defs>
  <style type="text/css">
   <![CDATA[
    @font-face {
	font-family: 'KeiFont-w';
	src: url('../fonts/KeiFont.woff') format('woff'),
	url('../fonts/KeiFont.ttf') format('truetype');
	}
	#japaneseID {font-family: 'KeiFont-w';}
   ]]>
 </style>
</defs>

<script type="text/javascript">
//
/*
* chai  - A simple digital language.
* 
@version 0.1.0 beta
* https://caixnet.github.io/
*
@copyright Daway.Cai,guangxian (caixnet@outlook.com)
* 
@license Apache
*
* BUILT: 2017/11/23  GMT+8 (BeiJing, China)
*/


var chia2japanese  = { 
"a":"あ", "i":"い", "u":"う", "ie":"え", "o":"お",
"ka":"か", "ki":"き", "ku":"く", "kie":"け", "ko":"こ",
"sa":"さ", "si":"し", "su":"す", "sie":"せ", "so":"そ",
"ta":"た", "ji":"ち","jy":"つ", "tie":"て", "to":"と",
"na":"な", "ni":"に", "nu":"ぬ", "nie":"ね", "no":"の",
"ha":"は", "hi":"ひ", "hu":"ふ", "hie":"へ", "ho":"ほ",
"ma":"ま", "mi":"み", "mu":"む", "mie":"め", "mo":"も",
"ra":"ら", "ri":"り", "ru":"る", "rie":"れ", "ro":"ろ",
"ya":"や", "yu":"ゆ", "yo":"よ",   
"oa":"わ", "lo":"を", "l":"ん",
"ga":"が", "gi":"ぎ", "gu":"ぐ", "gie":"げ", "go":"ご",
"za":"ざ", "zi":"じ", "zu":"ず", "zie":"ぜ", "zo":"ぞ",
"da":"だ", "jhi":"ぢ", "jhy":"づ", "die":"で", "do":"ど",
"va":"ば", "vi":"び", "vu":"ぶ", "vie":"べ", "vo":"ぼ",
"pa":"ぱ", "pi":"ぴ", "pu":"ぷ", "pie":"ぺ", "po":"ぽ",
"kya":"きゃ", "kyu":"きゅ", "kyo":"きょ",
"gya":"ぎゃ", "gyu":"ぎゅ", "gyo":"ぎょ",
"sya":"しゃ", "syu":"しゅ", "syo":"しょ",
"zya":"じゃ", "zyu":"じゅ", "zyo":"じょ",
"cya":"ちゃ", "cyu":"ちゅ", "cyo":"ちょ",
"jya":"ぢゃ", "jyu":"ぢゅ", "jyo":"ぢょ",
"nya":"にゃ", "nyu":"にゅ", "nyo":"にょ",
"hya":"ひゃ", "hyu":"ひゅ", "hyo":"ひょ",
"vya":"びゃ", "vyu":"びゅ", "vyo":"びょ",
"pya":"ぴゃ", "pyu":"ぴゅ", "pyo":"ぴょ",
"mya":"みゃ", "myu":"みゅ", "myo":"みょ",
"rya":"りゃ", "ryu":"りゅ", "ryo":"りょ",
"A":"ア", "I":"イ", "U":"ウ", "IE":"エ", "O":"オ",
"Ka":"カ", "Ki":"キ", "Ku":"ク", "Kie":"ケ", "Ko":"コ",
"Sa":"サ", "Si":"シ", "Su":"ス", "Sie":"セ", "So":"ソ",
"Ta":"タ", "Ji":"チ","Jy":"ツ", "Tie":"テ", "To":"ト",
"Na":"ナ", "Ni":"ニ", "Nu":"ヌ", "Nie":"ネ", "No":"ノ",
"Ha":"ハ", "Hi":"ヒ", "Hu":"フ", "Hie":"ヘ", "Ho":"ホ",
"Ma":"マ", "Mi":"ミ", "Mu":"ム", "Mie":"メ", "Mo":"モ",
"Ya":"ヤ", "Yu":"ユ", "Yo":"ヨ",
"Ra":"ラ", "Ri":"リ", "Ru":"ル", "Rie":"レ", "Ro":"ロ",
"Oa":"ワ", "Lo":"ヲ", "L":"ン",
"Ga":"ガ", "Gi":")ギ", "Gu":"グ", "Gie":"ゲ", "Go":"ゴ",
"Za":"ザ", "Zi":"ジ", "Zu":"ズ", "Zie":"ゼ", "Zo":"ゾ",
"Da":"ダ", "Jhi":"ヂ", "Jhy":"ヅ", "Die":"デ", "Do":"ド",
"Va":"バ", "Vi":"ビ", "Vu":"ブ", "Vie":"ベ", "Vo":"ボ",
"Pa":"パ", "Pi":"ピ", "Pu":"プ", "Pie":"ペ", "Po":"ポ",
"Kya":"キャ", "Kyu":"キュ", "Kyo":"キョ",
"Gya":"ギャ", "Gyu":"ギュ", "Gyo":"ギョ",
"Sya":"シャ", "Syu":"シュ", "Syo":"ショ",
"Zya":"ジャ", "Zyu":"ジュ", "Zyo":"ジョ",
"Cya":"チャ", "Cyu":"チュ", "Cyo":"チョ",
"Jya":"ヂャ", "Jyu":"ヂュ", "Jyo":"ヂョ",
"Nya":"ニャ", "Nyu":"ニュ", "Nyo":"ニョ",
"Hya":"ヒャ", "Hyu":"ヒュ", "Hyo":"ヒョ",
"Vya":"ビャ", "Vyu":"ビュ", "Vyo":"ビョ",
"Pya":"ピャ", "Pyu":"ピュ", "Pyo":"ピョ",
"Mya":"ミャ", "Myu":"ミュ", "Myo":"ミョ",
"Rya":"リャ", "Ryu":"リュ", "Ryo":"リョ"
}
//
</script>

<script type="text/javascript">
    <![CDATA[

// begin chai demo program
// define SVG 
var Svg={};
Svg.nx = 'http://www.w3.org/2000/svg';
Svg.xlink = 'http://www.w3.org/1999/xlink';
myWiki = 'https://github.com/caixnet/Chai/wiki';
var svg = document.getElementById('drawing');

// chai font image xy
var chaifont = {
    "eo" : [10,10], // left top
    "ao" : [30,10], // right top
    "au" : [30,50], // right button
    "eu" : [10,50] // left button
}
// chai font frame pints
var point = {
    '1': chaifont.eo,
    '2': chaifont.ao,
    '3': chaifont.au,
    '4': chaifont.eu
}
// define chai code
var chaicode = {
    "index" : 0,
    "a" : "1431", "b" : "124134", "c" : "1234", "d" : "1421", "e" : "12342", 
    "f" : "14324", "g" : "123", "h" : "14231", "i" : "13", "j" : "134", 
    "k" : "124", "l" : "143", "m" : "142132", "n" : "1423", "o" : "14321", 
    "p" : "12314", "q" : "14213", "r" : "143123", "s" : "12431", "t" : "1231", 
    "u" : "1432", "v" : "142", "w" : "1342", "x" : "1324", "y" : "132", "z" : "1243", 
    "0" : "234124", "1" : "24", "2" : "2134", "3" : "2143", "4" : "243", "5" : "2432",
    "6" : "23413", "7" : "214", "8" : "2413", "9" : "21423",
	"A" : "1431", "B" : "124134", "C" : "1234", "D" : "1421", "E" : "12342", 
    "F" : "14324", "G" : "123", "H" : "14231", "I" : "13", "J" : "134", 
    "K" : "124", "L" : "143", "M" : "142132", "N" : "1423", "O" : "14321", 
    "P" : "12314", "Q" : "14213", "R" : "143123", "S" : "12431", "T" : "1231", 
    "U" : "1432", "V" : "142", "W" : "1342", "X" : "1324", "Y" : "132", "Z" : "1243", 
    motion : function(pointArray, x = 0, y = 0){
        var xy = [];
        xy[0] = pointArray[0] + x;
        xy[1] = pointArray[1] + y;
        return xy; 
    },
    get : function(chai, x = 0, y = 0){ 
        var xys = [];
        for (i in this[chai]) {
            xys[i] =  this.motion(point[this[chai][i]],x,y);
        }
        return xys;
    },
    gets : function(word, x = 0, y = 0) {
        var xyz = [];
        for (i in word){
            xyz[i] = this.get(word[i], x*i, y);
        }
        return xyz;
    }
} 

// define demo of view window
var rect = function(){
	var rect = document.createElementNS(Svg.nx , 'rect');
	rect.setAttribute('id','chaiDemo');
	rect.setAttribute('width','320');
	rect.setAttribute('height','70');
	rect.setAttribute('fill','#ffccff');
	rect.setAttribute('stroke','#ffffcc');
	rect.setAttribute('stroke-width','2');
	rect.setAttribute('rx','7');
//	rect.setAttribute('href',myWiki);
//	rect.setAttribute('target',"_black");
	svg.appendChild(rect);
	return rect;
}
rect();
// define link on SVG image
var link = function(){
	var link = document.createElementNS(Svg.nx , 'a');
	link.setAttributeNS( Svg.xlink, "xlink:href", myWiki );
	link.setAttribute('xlink:show','new');
	link.appendChild(rect());
	svg.appendChild(link);
	return link;
}
//link();
// define copyright text line.
var copyright = function(word){
	var text = document.createElementNS(Svg.nx, 'text');
	text.setAttribute('x', '5');
	text.setAttribute('y', '65');
	text.setAttribute('fill', '#000');
	text.setAttribute("font-size","10");
	text.textContent = word ;
	svg.appendChild(text);
	return text;
}
copyright("Chai Language & Japanese #2017 by Daway, caixnet@outlook.com");
// define drawing char font
var drawChai = function(pathArray,id=0){
	var path = document.createElementNS(Svg.nx, "path");
	path.setAttribute("id","chaiID"+id);
    path.setAttribute("d","M"+ pathArray);
    path.setAttribute("fill", "none");
    path.setAttribute("stroke", "#0033cc");
    path.setAttribute("stroke-width", "4");
    path.setAttribute("stroke-linecap", "round");
    path.setAttribute("stroke-linejoin", "round");
	svg.appendChild(path);
	return path;
}
// define chai display
var chai=function(word="0"){
   var svgchai = [];
   var chars = chaicode.gets(word, 30); 
   for (i in chars )
   {
	  svgchai[i]=drawChai(chars[i].join(" "),i);  
   }

   return svgchai;
   
}
// define japanese display
var drawKorean = function(word){
	var text = document.createElementNS(Svg.nx, 'text');
	text.setAttribute("id","japaneseID");
	text.setAttribute('x', '200');
	text.setAttribute('y', '50');
	text.setAttribute('fill', '#339900');
	text.setAttribute("font-size","50");
	text.textContent = word ;
	//document.createTextNode(text)
	svg.appendChild(text);
	return text;
}
//  running state
var state = {
	locked:false,
	closed:false,
	lock:function(){ this.locked = true;},
	unlock:function(){ this.locked = false; this.closed=false;},
	close:function(){ this.closed = true;},
}
// remove resource
var removeElements = function(svgList,svgHan){
	var element_jp = document.getElementById('japaneseID');
	// remove Korean node
	try{
		svg.removeChild(element_jp);
	} catch (err){
		//console.log("remveding japanese error :"+err.message);
	}
    // remove Chai node
	for( i = 0; i <= 5; i++){
		var element_ch = document.getElementById('chaiID'+i);
		try{
			svg.removeChild(element_ch);
		}
		catch (err){
		//	console.log("remveding chai error :"+err.message);
		}
	}
    // release resource
	state.unlock();
}
// define demo characters 
var chaiList = Object.keys(chia2japanese );
var japaneseList = Object.values(chia2japanese );
var items = chaiList.length;
var count = 0;
var loopID = 0;
// deifne demo display
var demo=function(){
	
	var chaiElement = document.getElementById('chaiID');
	var japaneseElement = document.getElementById('jpaneseID');

	if (count >= items){	
		//clearInterval(loopID);
		count = 0;
	}else {
		if (state.locked == false && state.closed == false){
			ch = chai(chaiList[count]);
			jp = drawKorean(japaneseList[count]);
			state.lock();
		} else if ( state.closed == false && state.locked == true ){
			//console.log("remove.."+"ch:"+chaiList[count]+",jp:"+japaneseList[count]);
			count++;
			state.close();
			setTimeout(function(){  removeElements(ch,jp);}, 1000);
		} else{
			//console.log("locking... chai:"+chaiList[count]+",japanese:"+japaneseList[count])
		}

	}
	
}
// Chai Demo main function
var main=function(){

	// loop
	loopID = setInterval(demo, 100);
}
main();
// end chai demo program

    ]]>
</script>


</svg>